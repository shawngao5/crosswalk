<html>
<head>
    <title></title>
    <script>
    function printLog(msg){
        var div_logging = document.getElementById("logging");
        div_logging.innerHTML += "<li/>"
        div_logging.innerHTML += "Message:";
        div_logging.innerHTML += msg
    }
    xwalk.experimental.messaging.sms.onreceived = function(evt){
        printLog(JSON.stringify(evt));
    }
    xwalk.experimental.messaging.sms.onsent = function(evt){
        printLog(JSON.stringify(evt));
    }
    function test_send(){
        var text = "Hello XWalkman"
        xwalk.experimental.messaging.sms.send ( document.getElementById("phoneNumber").value, document.getElementById("messageText").value).done(
          function(body) {
            printLog(JSON.stringify(body));
        },
        function(error) {
            printLog(JSON.stringify(error));
        } )
    }

    function test_segmentInfo(){
        xwalk.experimental.messaging.sms.segmentInfo(document.getElementById("segmentText").value).done(
          function(body) {
            printLog(JSON.stringify(body))
        },
          function(error) {  printLog(JSON.stringify(error)); } )
    }

    function test_findMessages(){
        var filter = {
            type: "sms",
            //startDate: new Date("2013-11-27 00:00:00 GMT+8"),
            //startDate: new Date(),
            //endDate: new Date("2013-10-24 23:59:59 GMT+8"),
            //endDate: new Date(),
            //from: "23123123",
            //recipients: "",
            //state: "received",
            //serviceID: "",
            //read: true
        }

        var filterOption = {
            sortBy: "date",
            sortOrder: "descending",
            limit: 100
        }
        xwalk.experimental.messaging.findMessages(filter, filterOption).done(
          function(body) {
            printLog(JSON.stringify(body));
            var cursor = body;
            printLog(JSON.stringify(cursor.previous()));
            printLog(JSON.stringify(cursor.previous()));
        },
        function(error) {
            console.error('Error: ' + error);
        }
        );
    }

    function test_getMessage(){
        xwalk.experimental.messaging.getMessage("sms", document.getElementById("getMessageID").value).done(
          function(body) {
            printLog(JSON.stringify(body));
        },
        function(error) {
            console.error('Error: ' + error);
        }
        );
    }

    function test_deleteMessage(){

        xwalk.experimental.messaging.deleteMessage("sms", document.getElementById("deleteMessageID").value).done(
          function(body) {
            printLog(JSON.stringify(body));
        },
        function(error) {
            console.error('Error: ' + error);
        }
        );
    }

    function test_deleteConversation(){
        xwalk.experimental.messaging.deleteConversation("sms", document.getElementById("deleteConversationID").value).done(
          function(body) {
            printLog(JSON.stringify(body));
        },
        function(error) {
            console.error('Error: ' + error);
        }
        );
    }

    function test_markMessageRead(){
        xwalk.experimental.messaging.markMessageRead("sms", document.getElementById("markMessageReadID").value, false).done(
          function(body) {
            printLog(JSON.stringify(body));
        },
        function(error) {
            console.error('Error: ' + error);
        }
        );
    }

    function test_markConversationRead(){
        xwalk.experimental.messaging.markConversationRead("sms", document.getElementById("markConversationReadID").value, false).done(
          function(body) {
            printLog(JSON.stringify(body));
        },
        function(error) {
            console.error('Error: ' + error);
        }
        );
    }
    </script>
</head>
<body>
    <h1>
        <a href="#" onclick="test_send()">send</a><br/>
        phone:<input id="phoneNumber" type="text" value="5556"/><br/>
        text:<input id="messageText" type="text" value="Hello XWalk man!!"/><br/>

        <a href="#" onclick="test_segmentInfo()">segmentInfo</a><br/>
        <input id="segmentText" type="text" value="xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx xxxxxxxxxx "/><br/>
        <a href="#" onclick="test_findMessages()">findMessages</a><br/>
        <a href="#" onclick="test_getMessage()">getMessage</a><input id="getMessageID" type="text"/><br/>
        <a href="#" onclick="test_deleteMessage()">deleteMessage</a><br/>
        <input id="deleteMessageID" type="text"/><br/>
        <a href="#" onclick="test_deleteConversation()">deleteConversation</a><br/>
        <input id="deleteConversationID" type="text"/><br/>
        <a href="#" onclick="test_markMessageRead()">markMessageRead</a><br/>
        <input id="markMessageReadID" type="text"/><br/>
        <a href="#" onclick="test_markConversationRead()">markConversationRead</a><br/>
        <input id="markConversationReadID" type="text"/><br/>
    </h1>
    <h2>
        <div id="logging"/>
    </h2>
</body>
</html>
